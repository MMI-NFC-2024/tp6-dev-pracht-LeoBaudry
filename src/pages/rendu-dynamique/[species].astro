---
import Layout from "../../layouts/Layout.astro";
import PlotFigure from "../../components/PlotFigure.astro";
import * as Plot from "@observablehq/plot";
import penguins from "../../assets/penguins.json";

export const prerender = false;

const { species } = Astro.params;
const speciesName = decodeURIComponent(species);

const data = penguins.filter(p => p.species === speciesName);

const plotOptions = {
  grid: true,
  marks: [
    Plot.dot(
      data.filter(d => d.culmen_length_mm != null && d.culmen_depth_mm != null),
      {
        x: "culmen_length_mm",
        y: "culmen_depth_mm",
        stroke: "sex",
        r: 4,
        fillOpacity: 0.8,
      }
    ),
  ],
  x: { label: "Culmen length (mm)" },
  y: { label: "Culmen depth (mm)" },
  title: `Espèce ${speciesName}`,
};
---

<Layout>
<a class="btn btn-link mb-4" href="/rendu-dynamique">← Retour à la liste</a>
<h1 class="text-3xl font-bold mb-4 text-primary">Pingouins {speciesName}</h1>
<p class="mb-4 text-base-content">{data.length} enregistrement(s) pour cette espèce</p>
<div class="bg-base-200 rounded-box p-4">
    <PlotFigure options={plotOptions} />
</div>
</Layout>
